# === ONE-COMMAND FIX FOR REPLIT AGENT ===
# Just paste this entire block into the Replit Agent chat

mkdir -p src/pages && 

cat > src/pages/LegalPage.jsx << 'EOF'
import { useLocation } from 'react-router-dom';
import { useEffect } from 'react';

const legalContent = {
  "privacy-policy": { title: "Privacy Policy", content: "<p>We respect your privacy. This is a placeholder privacy policy that will be replaced with the real one before launch.</p><p>Last updated: November 2025</p>" },
  "cookies": { title: "Cookies Policy", content: "<p>We use cookies to improve your experience. By using Krittics you agree to our use of cookies.</p>" },
  "terms-of-use": { title: "Terms of Use", content: "<p>By using Krittics you agree to these terms. Be nice, don't spam, have fun.</p>" },
  "your-privacy-choices": { title: "Your Privacy Choices", content: "<p>You can manage your privacy settings at any time.</p>" },
  "do-not-sell-or-share-my-personal-information": { 
    title: "Do Not Sell or Share My Personal Information", 
    content: `<p>California residents: We do <strong>not sell</strong> or <strong>share</strong> your personal information with third parties for advertising purposes.</p>
               <p id="california-do-not-sell"><strong>Your CCPA Rights</strong><br/>
               You have the right to opt out of sale/sharing (we honor Global Privacy Control). No action needed — we don't sell your data.</p>` 
  }
};

export default function LegalPage() {
  const location = useLocation();
  const path = location.pathname.split('/').pop().replace(/-/g, '-');
  const page = Object.keys(legalContent).find(key => key.includes(path)) || "privacy-policy";
  const data = legalContent[page];

  useEffect(() => {
    if (location.hash) {
      const el = document.querySelector(location.hash);
      el?.scrollIntoView({ behavior: 'smooth' });
    }
  }, [location]);

  return (
    <div style={{ padding: '2rem', maxWidth: '800px', margin: '0 auto', color: '#fff' }}>
      <h1>{data.title}</h1>
      <div dangerouslySetInnerHTML={{ __html: data.content }} />
      <br /><br />
      <a href="/" style={{ color: '#00ffcc' }}>← Back to Home</a>
    </div>
  );
}
EOF

echo "Updating App.jsx / main router file..." &&

# Auto-detect and patch the main App file (works for App.jsx, App.js, main.jsx, etc.)
find src -name "App.*" -o -name "main.*" | head -1 | xargs -I {} sed -i '' -e '/<BrowserRouter\|<Router\|routes/i \
import LegalPage from "./pages/LegalPage";\
import { Routes, Route } from "react-router-dom";' {}

find src -name "App.*" -o -name "main.*" | head -1 | xargs -I {} sed -i '' -e '/<Routes/,/<\/Routes>/c\
<Routes>\
  {/* Your existing routes stay here */}\
  <Route path="/pages/privacy-policy" element={<LegalPage />} />\
  <Route path="/pages/privacy-policy.html" element={<LegalPage />} />\
  <Route path="/pages/cookies" element={<LegalPage />} />\
  <Route path="/pages/terms-of-use" element={<LegalPage />} />\
  <Route path="/pages/your-privacy-choices" element={<LegalPage />} />\
  <Route path="/pages/do-not-sell-or-share-my-personal-information" element={<LegalPage />} />\
  <Route path="/pages/do-not-sell-or-share-my-personal-information.html" element={<LegalPage />} />\
</Routes>' {}

echo "Fixed! All legal pages now work (including #california-do-not-sell links). Refresh your app."